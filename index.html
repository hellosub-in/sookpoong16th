<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>숙풍 제16회 정기공연 "도란도란"</title>

  <!-- OG 메타 -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="숙풍 제16회 정기공연 '도란도란'">
  <meta property="og:description" content="삼삼오오 정답게 모여 만들어내는 맑은 바람소리">
  <meta property="og:image" content="https://hellosub-in.github.io/sookpoong16th/thumbnail.png">
  <meta property="og:url" content="https://hellosub-in.github.io/sookpoong16th/">
  <meta name="twitter:card" content="summary_large_image">

  <style>
    html, body { margin: 0; padding: 0; }
    .toolbar {
      position: sticky; top: 0; z-index: 10;
      display: flex; gap: 8px; align-items: center;
      padding: 10px; background: #fff; border-bottom: 1px solid #eee;
    }
    .pages { padding: 10px; }
    .page-wrap { margin: 0 auto 16px; box-shadow: 0 2px 10px rgba(0,0,0,.06); }
    button { padding: 6px 10px; font-size: 14px; }
    .hint { margin-left: auto; font-size: 12px; opacity: .7; }
  </style>
</head>
<body>

  <div class="toolbar">
    <button id="zoomOut">－</button>
    <span id="zoomLevel">100%</span>
    <button id="zoomIn">＋</button>
    <a href="sookpoong16th_leaflet.pdf" target="_blank" rel="noopener" style="margin-left:12px">새 탭으로 열기</a>
    <span class="hint">모바일에서는 PDF.js 렌더링</span>
  </div>

  <div id="pages" class="pages" aria-live="polite"></div>

  <!-- PDF.js (legacy 빌드: script 태그로 바로 사용 가능) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.2.67/pdf.min.js"></script>
  <script>
    // 워커 설정 (PDF.js가 내부적으로 사용하는 스레드)
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.2.67/pdf.worker.min.js";

    const PDF_URL = "sookpoong16th_leaflet.pdf"; // <<-- PDF 파일명만 맞추세요
    let scale = 1.2; // 초기 확대배율
    const pagesEl = document.getElementById("pages");
    const zoomLevelEl = document.getElementById("zoomLevel");

    function updateZoomLabel() { zoomLevelEl.textContent = Math.round(scale*100) + "%"; }

    async function render(pdf) {
      pagesEl.innerHTML = "";
      const dpr = Math.min(window.devicePixelRatio || 1, 2); // 고해상도 화면 보정

      for (let p = 1; p <= pdf.numPages; p++) {
        const page = await pdf.getPage(p);
        const viewport = page.getViewport({ scale });

        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");

        // DPR 고려한 선명도 설정
        canvas.width  = Math.floor(viewport.width  * dpr);
        canvas.height = Math.floor(viewport.height * dpr);
        canvas.style.width  = Math.floor(viewport.width) + "px";
        canvas.style.height = Math.floor(viewport.height) + "px";

        const renderContext = {
          canvasContext: ctx,
          transform: dpr === 1 ? undefined : [dpr, 0, 0, dpr, 0, 0],
          viewport,
        };

        const wrap = document.createElement("div");
        wrap.className = "page-wrap";
        wrap.appendChild(canvas);
        pagesEl.appendChild(wrap);

        await page.render(renderContext).promise;
      }
      updateZoomLabel();
    }

    // PDF 로드 & 렌더
    pdfjsLib.getDocument(PDF_URL).promise.then(render);

    // 줌 컨트롤
    document.getElementById("zoomIn").addEventListener("click", () => {
      scale = Math.min(scale + 0.2, 3);
      pdfjsLib.getDocument(PDF_URL).promise.then(render);
    });
    document.getElementById("zoomOut").addEventListener("click", () => {
      scale = Math.max(scale - 0.2, 0.4);
      pdfjsLib.getDocument(PDF_URL).promise.then(render);
    });
  </script>
</body>
</html>
